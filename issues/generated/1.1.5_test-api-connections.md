# 1.1.5 – Test API connections

## Summary (Work Breakdown)

- **Description:** Run test scripts to verify OpenAI and Reddit APIs working
- **Work Package:** 2.1.4 Dependency Installation
- **Duration:** 0.5 hours
- **Owner(s):** Javier, Stefan, Edison

- **Story Detail:** https://github.com/nicolairobles/customer-pain-point-agent/blob/master/docs/stories/1.1.5-test-api-connections.md

## Detailed Story

# Story 1.1.5 – Test API Connections

## Purpose
Validate connectivity to OpenAI and Reddit services to de-risk downstream development.

## Acceptance Criteria
- [x] Smoke test scripts exist for OpenAI and Reddit, committed under `scripts/`.
- [x] Both scripts succeed using credentials from `.env`.
- [x] Failures produce actionable error messages logged to console.
- [x] Test results documented in project tracking tool with timestamp and tester name.
- [x] Retries and timeout guidance captured for future automation.

## Test Criteria
- [x] **Execution**: Run the OpenAI and Reddit smoke scripts back-to-back; both exit with status code 0.
- [x] **Logging**: Review logs for masked secrets and inclusion of request IDs where available.
- [x] **Automation Prep**: Integrate scripts into CI dry run (if available) to confirm they can be executed headlessly.

## Implementation Notes
- `scripts/test_openai_api.py` performs a minimal completion request against the Responses API, masking secrets in the logs and surfacing the response ID. Timeouts and actionable guidance are included when exceptions occur.
- `scripts/test_reddit_api.py` fetches a handful of hot submissions from a configurable subreddit. It validates credentials, applies a request timeout, and logs troubleshooting tips when failures occur.
- Operators can enable verbose logging via `--verbose` to capture debug payloads without leaking credentials. Suggested command sequence:
  1. `python3 scripts/test_openai_api.py --timeout 15`
  2. `python3 scripts/test_reddit_api.py --subreddit python --limit 3`
  Capture timestamps and tester name in the project tracker once both exit successfully.
- The scripts exit non-zero on failure, making them suitable for inclusion in future CI dry runs.
- Execution log (2025-11-12, tester recorded in tracker):
  - `python3 scripts/test_openai_api.py --timeout 5` → success (`HTTP/1.1 200 OK`, response ID `resp_0628578091796098006914e6662f00819794ba2a18aee158a7`, ~3.5 s). The script enforces `max_output_tokens >= 16` to comply with API requirements. Running this call incurs minimal OpenAI token cost.
  - `python3 scripts/test_reddit_api.py --subreddit python --limit 2` → success (~1.6 s for two titles).
